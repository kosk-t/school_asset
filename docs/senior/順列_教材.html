---
layout: material-raw
title: 順列
icon: "🔢"
description: nPrの公式を理解し、円順列・重複順列など様々なパターンの「並べ方」を計算できるようになる。
level: 基礎
level_num: 1
category: data
school_level: senior
order: 3
keywords:
  - 順列
  - nPr
  - 階乗
  - 円順列
  - 重複順列
cover_image: /images/noimage.jpg
cover_description: 順列の樹形図とnPrの公式
battle_game: false
toc:
  - id: section1
    title: "テーマの定義"
  - id: section2
    title: "覚えるルール"
  - id: section3
    title: "例題と解き方"
  - id: section4
    title: "簡単にするコツ"
  - id: section5
    title: "よくあるつまづき"
  - id: section6
    title: "仕上げチェックリスト"
  - id: section7
    title: "練習問題"
  - id: story
    title: "おまけ：歴史ストーリー「アーサー王の円卓会議」"
related:
  - url: /senior/場合の数_教材.html
    title: 場合の数
    note: 和の法則・積の法則の復習に
    type: prerequisite
---
<!-- ========== 1. テーマの定義 ========== -->
<section id="section1">
    <h2>1. テーマの定義</h2>
    <div class="section">
        <p>5人を一列に並べる方法は何通り？ 4桁の暗証番号は何パターン？ 「並べ方」を効率よく数える公式が<strong>順列</strong>です。</p>

        <p>このページでは、<strong>順列</strong>を学びます：</p>

        <ul>
            <li><strong>順列の公式 \(_nP_r\)</strong>：n個からr個を選んで並べる方法</li>
            <li><strong>階乗 \(n!\)</strong>：n個すべてを並べる特別な場合</li>
            <li><strong>円順列</strong>：円形に並べるときの特殊ルール</li>
            <li><strong>重複順列</strong>：同じものを何度も使えるとき</li>
        </ul>
    </div>
</section>

<!-- ========== 2. 覚えるルール ========== -->
<section id="section2">
    <h2>2. 覚えるルール</h2>
    <div class="section">
        <div class="important-rule">
            🎯 最重要：順列 \(_nP_r = n \times (n-1) \times \cdots \times (n-r+1)\)（n個からr個を選んで並べる）
        </div>

        <!-- 順列の図解（SVG） -->
        <div class="svg-container">
            <svg width="700" height="200" viewBox="0 0 700 200">
                <!-- タイトル -->
                <text x="350" y="25" font-size="16" font-weight="bold" fill="#1976d2" text-anchor="middle">順列のイメージ：5人から3人を選んで並べる（₅P₃）</text>

                <!-- 5人の候補 -->
                <text x="80" y="60" font-size="12" fill="#666" text-anchor="middle">5人の候補</text>
                <circle cx="30" cy="90" r="18" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                <text x="30" y="95" font-size="14" fill="#1976d2" text-anchor="middle">A</text>
                <circle cx="70" cy="90" r="18" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                <text x="70" y="95" font-size="14" fill="#1976d2" text-anchor="middle">B</text>
                <circle cx="110" cy="90" r="18" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                <text x="110" y="95" font-size="14" fill="#1976d2" text-anchor="middle">C</text>
                <circle cx="70" cy="130" r="18" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                <text x="70" y="135" font-size="14" fill="#1976d2" text-anchor="middle">D</text>
                <circle cx="30" cy="130" r="18" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                <text x="30" y="135" font-size="14" fill="#1976d2" text-anchor="middle">E</text>

                <!-- 矢印 -->
                <path d="M 140 100 L 200 100" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
                <defs>
                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#333"/>
                    </marker>
                </defs>

                <!-- 3つの席 -->
                <text x="350" y="60" font-size="12" fill="#666" text-anchor="middle">3つの席に順番に座る</text>

                <!-- 1番目の席 -->
                <rect x="220" y="80" width="70" height="50" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
                <text x="255" y="100" font-size="12" fill="#ff9800" text-anchor="middle">1番目</text>
                <text x="255" y="120" font-size="16" font-weight="bold" fill="#ff9800" text-anchor="middle">5通り</text>

                <!-- × -->
                <text x="305" y="110" font-size="20" fill="#333" text-anchor="middle">×</text>

                <!-- 2番目の席 -->
                <rect x="320" y="80" width="70" height="50" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
                <text x="355" y="100" font-size="12" fill="#4caf50" text-anchor="middle">2番目</text>
                <text x="355" y="120" font-size="16" font-weight="bold" fill="#4caf50" text-anchor="middle">4通り</text>

                <!-- × -->
                <text x="405" y="110" font-size="20" fill="#333" text-anchor="middle">×</text>

                <!-- 3番目の席 -->
                <rect x="420" y="80" width="70" height="50" fill="#fce4ec" stroke="#e91e63" stroke-width="2" rx="5"/>
                <text x="455" y="100" font-size="12" fill="#e91e63" text-anchor="middle">3番目</text>
                <text x="455" y="120" font-size="16" font-weight="bold" fill="#e91e63" text-anchor="middle">3通り</text>

                <!-- = -->
                <text x="510" y="110" font-size="20" fill="#333" text-anchor="middle">=</text>

                <!-- 結果 -->
                <rect x="530" y="80" width="140" height="50" fill="#f5f5f5" stroke="#333" stroke-width="2" rx="5"/>
                <text x="600" y="110" font-size="18" font-weight="bold" fill="#333" text-anchor="middle">60通り</text>

                <!-- 説明 -->
                <text x="350" y="170" font-size="14" fill="#333" text-anchor="middle">₅P₃ = 5 × 4 × 3 = 60</text>
                <text x="350" y="190" font-size="12" fill="#666" text-anchor="middle">（使った人は次の席では選べない → 選択肢が1つずつ減る）</text>
            </svg>
            <div class="svg-caption">順列：選んで並べるたびに選択肢が減っていく</div>
        </div>

        <div class="rule-box" id="rule-permutation">
            <strong>📌 ルール1：順列の公式</strong> <a href="#ex-basic" class="example-link">→ 例1</a>
            <div class="formula">
                \[ _nP_r = n \times (n-1) \times (n-2) \times \cdots \times (n-r+1) \]
            </div>
            <p>\(_nP_r\)：<strong>n</strong>個の中から<strong>r</strong>個を選んで<strong>一列に並べる</strong>方法の数</p>
            <p><strong>読み方：</strong>「nパーミュテーションr」または「n個からr個取る順列」</p>
            <p><strong>→ だから結果は：</strong> r個の因数を掛け算する（nから始めて1ずつ減らしながらr回掛ける）</p>
            <details class="thinking"><summary>💡 考え方を見る</summary>
            <p>1番目の席：n通り（全員が候補）</p>
            <p>2番目の席：n-1通り（1人使ったので残りから）</p>
            <p>3番目の席：n-2通り（2人使ったので...）</p>
            <p>...というように、使うたびに選択肢が1つ減っていく。これを積の法則で掛け合わせる。</p>
            </details>
        </div>

        <div class="rule-box" id="rule-factorial">
            <strong>📌 ルール2：階乗（n!）</strong> <a href="#ex-factorial" class="example-link">→ 例2</a>
            <div class="formula">
                \[ n! = n \times (n-1) \times (n-2) \times \cdots \times 2 \times 1 \]
            </div>
            <p><strong>階乗</strong>（\(n!\)、「nの階乗」と読む）：n個<strong>すべて</strong>を並べる場合の数</p>
            <p><strong>特別な値：</strong> \(0! = 1\)（定義）、\(1! = 1\)</p>
            <p><strong>→ だから結果は：</strong> \(_nP_n = n!\) が成り立つ</p>
            <table class="material-table">
                <tr>
                    <th>\(n\)</th>
                    <th>1</th>
                    <th>2</th>
                    <th>3</th>
                    <th>4</th>
                    <th>5</th>
                    <th>6</th>
                    <th>7</th>
                    <th>8</th>
                </tr>
                <tr>
                    <td>\(n!\)</td>
                    <td>1</td>
                    <td>2</td>
                    <td>6</td>
                    <td>24</td>
                    <td>120</td>
                    <td>720</td>
                    <td>5040</td>
                    <td>40320</td>
                </tr>
            </table>
        </div>

        <div class="rule-box" id="rule-factorial-formula">
            <strong>📌 ルール3：順列を階乗で表す</strong> <a href="#ex-factorial-formula" class="example-link">→ 例3</a>
            <div class="formula">
                \[ _nP_r = \frac{n!}{(n-r)!} \]
            </div>
            <p><strong>ポイント：</strong> この公式は計算を簡単にしたい場合や、組合せの公式を導くときに使う</p>
            <p><strong>✅ メリット：</strong> 電卓やプログラムで計算しやすい</p>
            <details class="thinking"><summary>💡 考え方を見る</summary>
            <p>\(_5P_3 = 5 \times 4 \times 3\) は、\(5! = 5 \times 4 \times 3 \times 2 \times 1\) から後半の \(2 \times 1 = 2!\) を割ったもの</p>
            <p>つまり \(_5P_3 = \frac{5!}{2!} = \frac{5!}{(5-3)!}\)</p>
            </details>
        </div>

        <div class="rule-box" id="rule-circular">
            <strong>📌 ルール4：円順列</strong> <a href="#ex-circular" class="example-link">→ 例4</a>
            <div class="formula">
                \[ \text{n人を円形に並べる方法} = (n-1)! \]
            </div>
            <p><strong>円順列</strong>：円形に並べるとき、回転して同じになるものは1通りと数える</p>
            <p><strong>→ だから結果は：</strong> 通常の順列 \(n!\) を n で割る（n通りの回転が同じ配置になるため）</p>
            <details class="thinking"><summary>💡 考え方を見る</summary>
            <p>円卓では「誰が最初か」という概念がない。例えばABCDの円形配置は、BはAの右、CはBの右...という相対的な位置関係だけが意味を持つ。</p>
            <p>1人を固定して考えると、残りの(n-1)人を並べる問題になる → (n-1)!</p>
            </details>
        </div>

        <!-- 円順列の図解（SVG） -->
        <div class="svg-container">
            <svg width="600" height="180" viewBox="0 0 600 180">
                <!-- タイトル -->
                <text x="300" y="20" font-size="14" font-weight="bold" fill="#1976d2" text-anchor="middle">円順列：回転して同じになるものは1通り</text>

                <!-- 4つの同じ配置 -->
                <!-- 配置1: ABCD -->
                <circle cx="80" cy="100" r="40" fill="none" stroke="#ccc" stroke-width="1" stroke-dasharray="5,5"/>
                <circle cx="80" cy="60" r="15" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                <text x="80" y="65" font-size="12" fill="#1976d2" text-anchor="middle">A</text>
                <circle cx="120" cy="100" r="15" fill="#fce4ec" stroke="#e91e63" stroke-width="2"/>
                <text x="120" y="105" font-size="12" fill="#e91e63" text-anchor="middle">B</text>
                <circle cx="80" cy="140" r="15" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
                <text x="80" y="145" font-size="12" fill="#4caf50" text-anchor="middle">C</text>
                <circle cx="40" cy="100" r="15" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
                <text x="40" y="105" font-size="12" fill="#ff9800" text-anchor="middle">D</text>

                <!-- = -->
                <text x="150" y="105" font-size="20" fill="#333" text-anchor="middle">=</text>

                <!-- 配置2: DABC (90度回転) -->
                <circle cx="220" cy="100" r="40" fill="none" stroke="#ccc" stroke-width="1" stroke-dasharray="5,5"/>
                <circle cx="220" cy="60" r="15" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
                <text x="220" y="65" font-size="12" fill="#ff9800" text-anchor="middle">D</text>
                <circle cx="260" cy="100" r="15" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                <text x="260" y="105" font-size="12" fill="#1976d2" text-anchor="middle">A</text>
                <circle cx="220" cy="140" r="15" fill="#fce4ec" stroke="#e91e63" stroke-width="2"/>
                <text x="220" y="145" font-size="12" fill="#e91e63" text-anchor="middle">B</text>
                <circle cx="180" cy="100" r="15" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
                <text x="180" y="105" font-size="12" fill="#4caf50" text-anchor="middle">C</text>

                <!-- = -->
                <text x="290" y="105" font-size="20" fill="#333" text-anchor="middle">=</text>

                <!-- 配置3: CDAB (180度回転) -->
                <circle cx="360" cy="100" r="40" fill="none" stroke="#ccc" stroke-width="1" stroke-dasharray="5,5"/>
                <circle cx="360" cy="60" r="15" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
                <text x="360" y="65" font-size="12" fill="#4caf50" text-anchor="middle">C</text>
                <circle cx="400" cy="100" r="15" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
                <text x="400" y="105" font-size="12" fill="#ff9800" text-anchor="middle">D</text>
                <circle cx="360" cy="140" r="15" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
                <text x="360" y="145" font-size="12" fill="#1976d2" text-anchor="middle">A</text>
                <circle cx="320" cy="100" r="15" fill="#fce4ec" stroke="#e91e63" stroke-width="2"/>
                <text x="320" y="105" font-size="12" fill="#e91e63" text-anchor="middle">B</text>

                <!-- = -->
                <text x="430" y="105" font-size="20" fill="#333" text-anchor="middle">=</text>

                <!-- ... -->
                <text x="470" y="105" font-size="16" fill="#666" text-anchor="middle">...</text>

                <!-- 結論 -->
                <rect x="500" y="75" width="80" height="50" fill="#f5f5f5" stroke="#333" stroke-width="2" rx="5"/>
                <text x="540" y="100" font-size="12" fill="#333" text-anchor="middle">すべて</text>
                <text x="540" y="115" font-size="14" font-weight="bold" fill="#333" text-anchor="middle">同じ配置</text>
            </svg>
            <div class="svg-caption">円順列では回転して一致するものを同一視する</div>
        </div>

        <div class="rule-box" id="rule-repetition">
            <strong>📌 ルール5：重複順列</strong> <a href="#ex-repetition" class="example-link">→ 例5</a>
            <div class="formula">
                \[ \text{n種類からr個を選んで並べる（重複OK）} = n^r \]
            </div>
            <p><strong>重複順列</strong>：同じものを何度でも使える場合の並べ方</p>
            <p><strong>→ だから結果は：</strong> 各位置でn通りの選択肢があり、それがr回 → 積の法則で \(n^r\)</p>
            <p><strong>例：</strong>4桁の暗証番号（0〜9の10種類、重複OK）= \(10^4 = 10000\) 通り</p>
        </div>
    </div>
</section>

<!-- ========== 3. 例題と解き方 ========== -->
<section id="section3">
    <h2>3. 例題と解き方</h2>
    <div class="section">
        <p>公式を使って実際に問題を解いてみましょう。</p>

        <h3 style="color: #1976d2; margin: 15px 0 10px 0;">▶ 基本の順列</h3>

        <div class="example-box" id="ex-basic">
            <div class="example-title">
                <span class="number-badge">例1</span>8人から3人を選んで一列に並べる
            </div>
            <p>8人の生徒から3人を選んで、委員長・副委員長・書記を決める方法は何通りか。</p>
            <p><strong>解き方：</strong></p>
            <ol>
                <li>8人から3人を選んで「順番をつけて」並べる → 順列</li>
                <li>公式 \(_nP_r\) を使う（n=8, r=3）</li>
            </ol>
            <div class="formula">
                \[ _8P_3 = 8 \times 7 \times 6 = 336 \text{通り} \]
            </div>
        </div>

        <div class="example-box" id="ex-factorial">
            <div class="example-title">
                <span class="number-badge">例2</span>5冊の本を本棚に並べる
            </div>
            <p>異なる5冊の本を本棚に一列に並べる方法は何通りか。</p>
            <p><strong>解き方：</strong></p>
            <ol>
                <li>5冊すべてを並べる → 階乗</li>
                <li>\(5!\) を計算</li>
            </ol>
            <div class="formula">
                \[ 5! = 5 \times 4 \times 3 \times 2 \times 1 = 120 \text{通り} \]
            </div>
        </div>

        <div class="example-box" id="ex-factorial-formula">
            <div class="example-title">
                <span class="number-badge">例3</span>階乗を使った計算
            </div>
            <p>\(_7P_4\) を階乗を使って計算せよ。</p>
            <p><strong>解き方：</strong></p>
            <ol>
                <li>公式 \(_nP_r = \frac{n!}{(n-r)!}\) を使う</li>
                <li>n=7, r=4 を代入</li>
            </ol>
            <div class="formula">
                \[ _7P_4 = \frac{7!}{(7-4)!} = \frac{7!}{3!} = \frac{5040}{6} = 840 \text{通り} \]
            </div>
            <p><strong>別解：</strong> \(_7P_4 = 7 \times 6 \times 5 \times 4 = 840\)（直接計算の方が速い場合も多い）</p>
        </div>

        <h3 style="color: #1976d2; margin: 25px 0 10px 0;">▶ 円順列</h3>

        <div class="example-box" id="ex-circular">
            <div class="example-title">
                <span class="number-badge">例4</span>円卓に6人を座らせる
            </div>
            <p>6人を円形のテーブルに座らせる方法は何通りか。</p>
            <p><strong>解き方：</strong></p>
            <ol>
                <li>円形に並べる → 円順列</li>
                <li>公式 \((n-1)!\) を使う（n=6）</li>
            </ol>
            <div class="formula">
                \[ (6-1)! = 5! = 120 \text{通り} \]
            </div>
            <p><strong>補足：</strong>一列に並べると \(6! = 720\) 通りだが、円卓では回転して同じになる6通りを1つと数えるので \(\frac{720}{6} = 120\)</p>
        </div>

        <h3 style="color: #1976d2; margin: 25px 0 10px 0;">▶ 重複順列</h3>

        <div class="example-box" id="ex-repetition">
            <div class="example-title">
                <span class="number-badge">例5</span>4桁の暗証番号
            </div>
            <p>0〜9の数字を使って4桁の暗証番号を作る。同じ数字を何度使ってもよいとき、何通りあるか。</p>
            <p><strong>解き方：</strong></p>
            <ol>
                <li>同じ数字を何度も使える → 重複順列</li>
                <li>各桁で10通りの選択肢、それが4桁</li>
            </ol>
            <div class="formula">
                \[ 10^4 = 10000 \text{通り} \]
            </div>
        </div>

        <h3 style="color: #1976d2; margin: 25px 0 10px 0;">▶ 条件付き順列</h3>

        <div class="example-box" id="ex-condition">
            <div class="example-title">
                <span class="number-badge">例6</span>特定の2人が隣り合う
            </div>
            <p>A, B, C, D, Eの5人を一列に並べる。AとBが隣り合う並べ方は何通りか。</p>
            <p><strong>解き方：</strong></p>
            <ol>
                <li>AとBを「1組のセット」として考える</li>
                <li>セット + C, D, E = 4つのものを並べる → \(4!\) 通り</li>
                <li>セット内でAとBの順番が2通り（AB or BA）</li>
                <li>積の法則で掛け合わせる</li>
            </ol>
            <div class="formula">
                \[ 4! \times 2 = 24 \times 2 = 48 \text{通り} \]
            </div>
        </div>

        <div class="example-box" id="ex-not-adjacent">
            <div class="example-title">
                <span class="number-badge">例7</span>特定の2人が隣り合わない
            </div>
            <p>A, B, C, D, Eの5人を一列に並べる。AとBが隣り合わない並べ方は何通りか。</p>
            <p><strong>解き方：</strong></p>
            <ol>
                <li>全体から「隣り合う場合」を引く（余事象）</li>
                <li>全体：\(5! = 120\) 通り</li>
                <li>隣り合う場合：48通り（例6より）</li>
            </ol>
            <div class="formula">
                \[ 120 - 48 = 72 \text{通り} \]
            </div>
        </div>
    </div>
</section>

<!-- ========== 4. 簡単にするコツ ========== -->
<section id="section4">
    <h2>4. 簡単にするコツ</h2>
    <div class="section">
        <div class="tip-box">
            <strong>✏️ コツ1：「順番が大事か？」で判断</strong><br>
            並べ方に順番がある（1位・2位・3位など）→ 順列<br>
            選ぶだけで順番は関係ない → 組合せ（次回学習）
        </div>

        <div class="tip-box">
            <strong>✏️ コツ2：直接計算 vs 階乗公式</strong><br>
            \(_8P_3 = 8 \times 7 \times 6\) の方が \(\frac{8!}{5!}\) より速い。<br>
            階乗公式は、組合せとの関連や証明で使うことが多い。
        </div>

        <div class="tip-box">
            <strong>✏️ コツ3：「セットにする」テクニック</strong><br>
            「AとBが隣り合う」→ ABを1つのセットとして並べる<br>
            「AとBが隣り合わない」→ 全体 − 隣り合う（余事象）
        </div>

        <div class="tip-box">
            <strong>✏️ コツ4：円順列は「1人を固定」</strong><br>
            円形に並べるときは、1人を固定して考える。<br>
            残りの(n-1)人を並べる問題に帰着 → (n-1)!
        </div>
    </div>
</section>

<!-- ========== 5. よくあるつまづき ========== -->
<section id="section5">
    <h2>5. よくあるつまづき</h2>
    <div class="section">
        <div class="caution-box">
            <div class="caution-title">⚠️ つまづき1：順列と組合せの混同</div>
            <p><strong>ダメな例：</strong>「5人から3人を選ぶ」で \(_5P_3\) を使う</p>
            <p><strong>対策：</strong>「選んで並べる」（委員長・副委員長など役職がある）→ 順列<br>
            「選ぶだけ」（グループを作るなど）→ 組合せ</p>
        </div>

        <div class="caution-box">
            <div class="caution-title">⚠️ つまづき2：円順列で普通のn!を使う</div>
            <p><strong>ダメな例：</strong>「6人を円卓に並べる」で \(6! = 720\) と答える</p>
            <p><strong>対策：</strong>円形では回転して同じものを1通りと数える → \((n-1)!\)</p>
        </div>

        <div class="caution-box">
            <div class="caution-title">⚠️ つまづき3：重複順列と普通の順列の混同</div>
            <p><strong>ダメな例：</strong>「4桁の暗証番号」で \(_{10}P_4\) を使う</p>
            <p><strong>対策：</strong>「同じものを何度も使える」→ 重複順列 \(n^r\)<br>
            「一度使ったら使えない」→ 普通の順列 \(_nP_r\)</p>
        </div>

        <div class="caution-box">
            <div class="caution-title">⚠️ つまづき4：セット内の並び方を忘れる</div>
            <p><strong>ダメな例：</strong>「AとBが隣り合う」で、ABを1セットにして \(4!\) だけ答える</p>
            <p><strong>対策：</strong>セット内の順番（ABかBAか）も考える → \(4! \times 2!\)</p>
        </div>
    </div>
</section>

<!-- ========== 6. 仕上げチェックリスト ========== -->
<section id="section6">
    <h2>6. 仕上げチェックリスト</h2>
    <div class="section">
        <div class="checklist">
            <div class="checklist-item">\(_nP_r\) の計算ができる（n×(n-1)×...を r 個）</div>
            <div class="checklist-item">階乗 \(n!\) の意味と計算ができる</div>
            <div class="checklist-item">円順列で \((n-1)!\) を使える</div>
            <div class="checklist-item">重複順列で \(n^r\) を使える</div>
            <div class="checklist-item">「隣り合う」問題をセット化して解ける</div>
        </div>
    </div>
</section>

<!-- ========== 7. 練習問題 ========== -->
<section id="section7">
    <h2>7. 練習問題</h2>
    <div class="section">
        <p>学んだことを使って、以下の問題を解いてみよう。</p>

        <div class="rule-box" style="background: #f5f5f5;">
            <strong>練習1</strong>
            <p>10人から4人を選んで一列に並べる方法は何通りか。</p>
            <details style="margin-top: 15px;">
                <summary style="cursor: pointer; color: #4caf50; font-weight: bold;">答えを見る</summary>
                <div style="margin-top: 10px; padding: 10px; background: #e8f5e9; border-radius: 5px;">
                    <p>\(_{10}P_4 = 10 \times 9 \times 8 \times 7 = 5040\) 通り</p>
                </div>
            </details>
        </div>

        <div class="rule-box" style="background: #f5f5f5; margin-top: 15px;">
            <strong>練習2</strong>
            <p>8人を円形のテーブルに座らせる方法は何通りか。</p>
            <details style="margin-top: 15px;">
                <summary style="cursor: pointer; color: #4caf50; font-weight: bold;">答えを見る</summary>
                <div style="margin-top: 10px; padding: 10px; background: #e8f5e9; border-radius: 5px;">
                    <p>円順列なので \((8-1)! = 7! = 5040\) 通り</p>
                </div>
            </details>
        </div>

        <div class="rule-box" style="background: #f5f5f5; margin-top: 15px;">
            <strong>練習3</strong>
            <p>A〜Fの6人を一列に並べるとき、AとBが両端にくる並べ方は何通りか。</p>
            <details style="margin-top: 15px;">
                <summary style="cursor: pointer; color: #4caf50; font-weight: bold;">答えを見る</summary>
                <div style="margin-top: 10px; padding: 10px; background: #e8f5e9; border-radius: 5px;">
                    <p>両端の選び方：Aが左端・Bが右端、または Bが左端・Aが右端 → 2通り</p>
                    <p>残りの4人（C, D, E, F）を中央4箇所に並べる → \(4! = 24\) 通り</p>
                    <p>答え：\(2 \times 24 = 48\) 通り</p>
                </div>
            </details>
        </div>
    </div>
</section>

<!-- ========== まとめ ========== -->
<div class="summary">
    📌 まとめ：順列は「選んで並べる」→ \(_nP_r\)。円形なら \((n-1)!\)、重複OKなら \(n^r\)！
</div>

<!-- ========== おまけ：歴史ストーリー ========== -->
<section id="story">
    <h2>おまけ：歴史ストーリー「アーサー王の円卓会議」</h2>
    <div class="section">
        <div class="story-box">
            <div class="story-title">📖 なぜ「円卓」だったのか（5世紀頃・ブリテン）</div>

            <p>アーサー王伝説で有名な<strong>円卓の騎士</strong>。なぜアーサー王は「円い」テーブルを選んだのか？</p>

            <p>伝説によれば、騎士たちは「誰が上座か」で揉めに揉めた。長方形のテーブルだと、王から遠い席は「格下」扱い。騎士たちのプライドがぶつかり合い、会議どころではなかった。</p>

            <p>そこでアーサー王は考えた。</p>

            <p><strong>「円形にすれば、全員が平等だ」</strong></p>

            <p>円卓には「上座」がない。誰も「端っこ」に座らされることがない。騎士たちは対等な仲間として議論できるようになった。</p>

            <p>さて、ここで数学の問題。<strong>12人の騎士を円卓に座らせる方法は何通りか？</strong></p>

            <p>一列なら \(12! = 479,001,600\) 通り（約4.8億通り！）</p>

            <p>しかし円卓では、<strong>回転して同じになるものは1通り</strong>と数える。</p>

            <div class="formula">
                \[ (12-1)! = 11! = 39,916,800 \text{通り} \]
            </div>

            <p>それでも約4000万通り。12人の座り方だけでこの数だ。</p>

            <p>ちなみに、伝説によると円卓の騎士は<strong>150人</strong>いたとも言われる。その場合の座り方は...</p>

            <div class="formula">
                \[ 149! \approx 3.4 \times 10^{262} \]
            </div>

            <p>宇宙の原子の数（約 \(10^{80}\)）をはるかに超える。騎士たちが毎日違う座り方を試しても、宇宙が終わるまでに試せるのはほんの一部だ。</p>

            <p><strong>教訓：平等は素晴らしいが、席替えは計画的に。</strong></p>

            <p style="font-size: 0.9em; color: #666; margin-top: 15px;">※円卓の騎士の人数は文献により異なります。詳しくは<a href="https://ja.wikipedia.org/wiki/%E5%86%86%E5%8D%93%E3%81%AE%E9%A8%8E%E5%A3%AB" target="_blank" style="color: #1976d2;">円卓の騎士 - Wikipedia</a>を参照。</p>
        </div>
    </div>
</section>
